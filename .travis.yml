language: c
#######################################################################################
os:
  - linux
  
sudo: enabled

addons:
  apt:
    packages:
      - curl

#######################################################################################


before_install:

  - sudo apt-get update && sudo apt-get upgrade -qq
  - sudo apt-get install git ccache automake lzop bison gperf build-essential zip curl zlib1g-dev zlib1g-dev:i386 g++-multilib python-networkx libxml2-utils bzip2 libbz2-dev libbz2-1.0 libghc-bzlib-dev squashfs-tools pngcrush schedtool dpkg-dev liblz4-tool make optipng
  - git clone https://android.googlesource.com/platform/prebuilts/gcc/linux-x86/arm/arm-eabi-4.8 ~/arm-eabi-4.8/
  - sudo chmod -R a+x *

#######################################################################################


script:  
  #- mkdir -p out
  #- make O=out clean
  #- make O=out mrproper
  - export CROSS_COMPILE=~/arm-eabi-4.8/bin/arm-eabi-
  - export ARCH_MTK_PLATFORM=mt6735
  - export ARCH=arm 
  - export KBUILD_BUILD_USER="fujitsu"
  - export KBUILD_BUILD_HOST="ALGPHELLO"
  - make mt6737t-grandpplte_defconfig
  #- KERNEL_DIR=$PWD/android_kernel_samsung_grandpplteser
  #- ZIMAGE=$KERNEL_DIR/arch/arm/boot/zImage
  #- bash build.sh
  
  #- make CROSS_COMPILE=$CROSS_COMPILE O=out
  - make -j16
 
deploy:
  skip_cleanup: true
  provider: releases
  api_key: "$GIT_OAUTH_TOKEN_TB"
  
  on:
    tags: false
    repo: ALGPHELLO/android_kernel_samsung_grandpplteser
    branch: master

branches:
  except:
    - /^(?i:untagged)-.*$/
